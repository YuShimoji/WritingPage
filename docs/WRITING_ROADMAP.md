# 執筆ロードマップ — Zen Writer

> 小説執筆からグラフィックノベルまで、段階的に機能を解放するフェーズ設計

## 設計思想

- **フェーズ 1 が快適でなければ、2 以降に意味はない**
- 各フェーズは前のフェーズが安定してから着手
- 機能追加よりも「今ある機能が正しく動く」ことを優先

---

## Phase 1: 書く — プレーンテキスト執筆の完成

**ゴール**: テキストエディタとして不満なく使える状態

| 項目 | タスク | 優先度 |
|------|--------|--------|
| エディタスクロール修正 | TASK_053 | P0 |
| サイドバー簡素化 | TASK_057a | P1 |
| フローティングパネル修正 | TASK_054 | P1 |
| 文字数カウント常時表示 | ツールバーに統合済み（確認） | — |
| 自動保存の安定化 | 動作確認・UIフィードバック改善 | P1 |
| ドキュメント切替の安定化 | サイドバー上部に固定表示 | P1 |

### Phase 1 完了基準

- [ ] テキストを10,000字書いてスクロール・編集・保存が正常
- [ ] ドキュメント切替でデータロスが起きない
- [ ] サイドバーを開かなくても基本的な執筆ができる
- [ ] モバイル (768px以下) でも最低限の執筆が可能

---

## Phase 2: 整理する — 章・話数管理とナビゲーション

**ゴール**: 長編小説を構造的に管理できる

| 項目 | 説明 | 依存 |
|------|------|------|
| 章/話数分割 | Markdown 見出し（`#`, `##`）ベースで自動検出 | Phase 1 |
| アウトラインナビゲーション | サイドバーに Tree View 表示、クリックでジャンプ | Phase 1, TASK_057b |
| ドキュメント間リンク | `doc://` プロトコルで柔軟にジャンプ | Phase 1 |
| 章間比較 | スプリットビューの章間比較モード安定化 | Phase 1 |
| スナップショット差分 | バージョン間の差分表示 | Phase 1 |
| タグ・スマートフォルダ | ドキュメントにタグ付けして分類 | Phase 1 |

### Phase 2 完了基準

- [ ] 10万字超の長編を章単位でナビゲーションできる
- [ ] ドキュメント間リンクで自由に行き来できる
- [ ] アウトラインから任意の見出しにワンクリックで移動

---

## Phase 3: 分析する — AI Wiki 生成

**ゴール**: 執筆した小説を AI が分析し、ファンダム風 Wiki を自動生成

| 項目 | 説明 | 依存 |
|------|------|------|
| AI 接続基盤 | API キー設定、プロンプトテンプレート | Phase 2 |
| キャラクター抽出 | 小説中の登場人物を自動識別 | Phase 2 |
| 世界観・用語集生成 | 設定・地名・固有名詞の辞書化 | Phase 2 |
| Wiki ページ自動生成 | 抽出した情報から Wiki ページを作成 | Phase 2 |
| Wiki ⇔ 本文リンク | Wiki ページから本文の該当箇所にジャンプ | Phase 2 |
| 差分更新 | 本文を更新したら Wiki も差分更新 | Phase 3 初期 |

### Phase 3 完了基準

- [ ] 小説を分析して主要キャラクター/世界観の Wiki が自動生成される
- [ ] Wiki ページから該当シーンに直接ジャンプできる
- [ ] 本文更新時に Wiki が差分更新される

---

## Phase 4: 魅せる — リッチテキスト・グラフィックノベル

**ゴール**: テキストにリッチな装飾・アニメーション・画像を加え、グラフィックノベル風の表現が可能

| 項目 | タスク | 依存 |
|------|--------|------|
| WYSIWYG エディタ安定化 | TASK_055 | Phase 1 |
| テキストアニメーション再生 | TASK_056 | Phase 1, TASK_055 |
| 画像挿入・配置 | エディタ内画像ドラッグ&ドロップ | Phase 1 |
| コラージュレイアウト | 画像＋テキストのグリッド配置 | Phase 2 |
| フォント装飾プレビュー | 装飾がリアルタイムで反映 | TASK_054, TASK_055 |
| エクスポート | PDF / EPUB / HTML 出力 | Phase 2 |

### Phase 4 完了基準

- [ ] テキスト＋画像＋アニメーションの複合表現ができる
- [ ] WYSIWYG で「書きながらリッチ表示を確認」できる
- [ ] 完成した作品を PDF/EPUB にエクスポートできる

---

## フェーズ間の依存関係

```
Phase 1 (書く)
  ↓ 安定したら
Phase 2 (整理する)
  ↓ ナビゲーション完成したら
Phase 3 (分析する)      Phase 4 (魅せる)
  ↑                        ↑
  └── Phase 2 ─────────────┘
```

Phase 3 と Phase 4 は並行作業可能だが、どちらも Phase 2 が前提。
Phase 4 の一部（WYSIWYG 安定化）は Phase 1 完了後に早期着手可能。

---

## 現在の着手順序（推奨）

1. **TASK_053** — エディタスクロール修正（P0、これがないと何も始まらない）
2. **TASK_057a** — サイドバー簡素化（P1、執筆体験の改善）
3. **TASK_054** — フローティングパネル修正（P1）
4. **TASK_055 Phase 1** — WYSIWYG 多重呼び出し修正（P1）
5. **TASK_056** — テキストアニメーション再生（P2）
6. **TASK_057b** — サイドバー中期改善（Phase 2 連携）
