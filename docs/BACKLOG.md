# BACKLOG — 初期課題一覧

## 優先度: 高

- [x] 複数ドキュメント管理（保存/一覧/切替/削除） - 実装済み
- [x] 追加テーマプリセット（高コントラスト、ソラリゼド） - Themesガジェットに実装
- [x] オートバックアップ（一定間隔/変更量でスナップショット） - 実装済み
- [x] カラーパレットUIの追加（プリセットからの色選択、プレビュー、適用/取消） - Themesガジェットに実装
- [x] テーマUIの極小化と「設定ハブ」への移動（左サイドバーの情報量削減） - タイポガジェット化で対応
- [x] ワードカウントバーの開閉（常時表示/自動隠し/手動トグル） - 実装済み
- [x] updateWordCountデバウンス実装（長文パフォーマンス向上） - 300msデバウンスでinputイベント最適化完了
- [x] typewriter scroll requestAnimationFrame適用（スクロール振動解消）
- [x] live previewデバウンス適用（100msデバウンスで高頻度入力時のパフォーマンス改善）- 2025-12-02完了
- [x] live preview差分適用（morphdomによるDOM差分更新）- 2025-12-03完了、スクロール位置・フォーカス保持

## 優先度: 中

- [x] 印刷用スタイル最適化（章タイトル、段落間隔）
- [x] PDFエクスポート（ブラウザ印刷のガイド整備） - Documentsガジェットに実装
- [x] 執筆目標（文字数/締切）と進捗バー - HUDSettingsガジェットに実装
- [x] 配色プリセットの保存/読み込み（ユーザー定義プリセット） - Themesガジェットに実装
- [x] フォント設定の適用範囲の明確化（本文フォント vs UIフォント）
- [x] エディタ余白・最大幅の調整機能（余白エリアの背景色カスタマイズ含む） - EditorLayoutガジェットに実装
- [ ] テーマプリセット拡張のための集中管理機構（ThemeManager / Themesガジェット / CSS変数の定義を一元化し、新規プリセット追加フローを整理）【カテゴリ: テーマ/配色】
- [ ] UI配色と執筆エリア配色の分離（テーマガジェットの「文字色」をUI/エディタで分離し、本文の装飾/配色はテーマから独立した層として再設計）【カテゴリ: テーマ/配色/エディタ設計】
- [ ] ビジュアルUIエディタ - クリックで要素選択、個別またはタイプ別の一括色変更【フェーズ候補: v0.4.x / カテゴリ: UIエディタ・テーマ調整】
- [ ] フローティングパネル機能 - サイドバーから切り離し、透明度調整、表示/非表示トグル【フェーズ候補: v0.4.x / カテゴリ: パネル/レイアウト】
- [ ] 柔軟なタブ配置システム - 上下左右への配置、サイドバー内での順序変更【フェーズ候補: v0.4.x / カテゴリ: パネル/レイアウト】
- [ ] タブへのガジェット動的割り当て完全実装 - ドラッグ&ドロップでガジェットをタブに追加【フェーズ候補: v0.4.x / カテゴリ: パネル/レイアウト】
- [x] 見出し階層のハードコーディング解消（テンプレート機構に統一）- UILabels使用、ユーザー定義プリセット作成可能
- [x] 用語整備・仕様遵守（UIラベルの統一）- ロードアウト/プロファイル関連ラベルを ui-labels.js に集約・重複解消済み
- [x] フェードイン/アウト型ミニHUD（文字数ほか拡張可能な小ウィンドウ）- HUDSettingsガジェットで位置/時間/色/不透明度/幅をカスタマイズ可能
- [x] 検索置換機能（エディタ内検索/置換）- 基本UI実装済み（Ctrl+F で開閉、正規表現/大文字小文字オプション対応）
- [ ] スペルチェック（基本的なスペル提案）【フェーズ候補: v0.4.x 以降 / カテゴリ: 入力支援・言語処理】
- [x] 自動保存設定（間隔/条件のカスタマイズ）- UISettingsガジェットに実装
- [x] ヘルプ/チュートリアル（オンラインヘルプ、ショートカット一覧）- Helpガジェット実装済み、EDITOR_HELP.md整備済み
- [x] 破棄確認・復元機能強化（履歴UI、ゴミ箱、ショートカット）- Ctrl+Shift+Z 復元、復元前自動バックアップ、最新強調表示、プレビュー機能実装
- [x] selection range measurement最適化（文字数スタンプ位置計算負荷削減）- updateCharCountStamps に100msデバウンス追加
- [x] Visual Profile Phase A（概念モデル、最小UI、editorWidthMode）- 実装済み
- [x] Visual Profile Phase B（保存/読込 UI、ユーザー定義プロファイル）- ガジェット実装済み
- [x] サイドバー＆ガジェット構造の安定化（データ属性ベースの安定セレクタ導入、ガジェットグループ正規化、SidebarManager と ZWGadgets の責務分離整理）（Cフェーズ完了）
- [x] UIモード実装 (Normal/Focus/Blank) - settings.ui.uiMode と data-ui-mode 属性によるモード切替、F2でサイクル切替、Escでnormalに復帰 - 2025-12-03完了
- [x] ワードカウント/進捗ヘッダーの再配置（エディタ上部から HUD/ガジェット等への退避と改行削減）【フェーズ候補: v0.4.x / カテゴリ: HUD・情報レイアウト】
- [x] テーマごとのボタン/リンクアクセントカラー一括制御（テーマ/Visual Profile と連携したスタイル適用）- 2025-12-02完了、css/style.cssとcss/special.cssで--accent-color変数を統一
- [ ] Typora風ツリーペイン（ドキュメント/メモ/Markdown管理を統合するツリーUIの設計と段階的実装）【フェーズ候補: 長期 / カテゴリ: ドキュメントナビゲーション】

## 優先度: 低

- [x] PRテンプレートの追加 - .github/pull_request_template.md に実装済み
- [ ] コード規約の明文化（ESLint/Prettier導入検討）【フェーズ候補: 継続 / カテゴリ: コーディング規約・静的解析】
- [ ] プラグイン拡張システム（ユーザー定義ガジェット）【フェーズ候補: 長期 / カテゴリ: 拡張性・プラグイン】
- [ ] レスポンシブUI改善（モバイル/タブレット対応）【フェーズ候補: 長期 / カテゴリ: レスポンシブデザイン】
- [ ] アクセシビリティ向上（キーボード操作、スクリーンリーダー対応）【フェーズ候補: 長期 / カテゴリ: アクセシビリティ】

## バグ/改善候補

- [x] 長文貼り付け時のパフォーマンス計測 - 5k-50k文字で約300ms、許容範囲（scripts/perf-paste-test.js）
- [x] 絵文字をアイコンに置き換え（ミニマルモダン方針）- Done/テキスト形式に変更済み
- [x] ロードアウト管理のガジェット化 - gadgets-loadout.js に分離、HTMLから静的要素を削除
- [x] ダークテーマでのコントラスト検証 - Obsidian/Quiver風にリファイン済み
- [x] ロードアウト削除時の二重確認ポップアップ修正 - app.js の confirm 削除で統一
- [x] TypographyThemes ガジェット分割（Themes, Typography, VisualProfile の3つに責務分離）- 2025-12-03完了
- [x] 新規ドキュメント作成フローでの未保存確認・スナップショット退避の二重実行を整理（1回のダイアログ＋退避に統合） - gadgets.js に未保存確認追加で統一
- [x] ドキュメント切り替え時の未保存確認統一（自動保存無効時のみ確認ダイアログ表示）- 実装済み

## 次期フェーズ案（v0.4.x）

### フェーズ C: サイドバー構造安定化（完了）

#### C-1: データ属性スキーマ導入

- [x] `data-gadget-group`, `data-gadget-id` 等の安定セレクタを定義 - GADGET_GROUPS オブジェクトを gadgets-utils.js に追加
- [x] index.html のガジェットパネルにデータ属性を追加 - 既存の data-gadget-group, data-group を活用
- [x] CSS/JS で脆い ID/クラスセレクタ依存をデータ属性経由に移行 - gadgets-init.js, gadgets-core.js を更新

#### C-2: SidebarManager と ZWGadgets の責務分離

- [x] SidebarManager: タブ切替/グループ表示制御に専念 - 責務をコメントで明確化
- [x] ZWGadgets: ガジェット登録/レンダリング/設定管理に専念 - 責務をコメントで明確化
- [x] 両者の境界を明確化し、循環参照を排除 - addTab での連携ポイントを文書化

#### C-3: ガジェットグループ正規化

- [x] グループ名を定数化（GADGET_GROUPS オブジェクト）- gadgets-utils.js に定義済み
- [x] ロードアウト定義でのグループ名をバリデーション - isValidGroup 関数を追加
- [x] 未知グループへの登録時に警告ログ出力 - getGroupPanel で警告出力

### フェーズ D: HUD/進捗機能拡張（完了）

- [x] フェードイン/アウト型ミニHUD（位置・フェード時間・背景色のカスタマイズ）- HUDSettingsガジェットで実装済み
- [x] ワードカウント/進捗ヘッダーの再配置（エディタ上部から HUD への退避）- 2025-12-02完了
- [x] 執筆目標の進捗可視化 - HUDSettingsガジェットで実装済み

### フェーズ E: パネル・レイアウト機能

- [x] フローティングパネル PoC（structure限定）- 2025-12-05完了、UISettingsから起動可能
- フローティングパネル機能の本実装（全タブ対応、透明度調整、位置保存）
- 柔軟なタブ配置システム（上下左右への配置）
- タブへのガジェット動的割り当て（ドラッグ&ドロップ）

### 長期課題

- [x] live preview差分適用（morphdomによるDOM差分更新）- 2025-12-03完了
- Typora風ツリーペイン（ドキュメント管理統合）【対応: 上記「優先度: 中」の同名タスクと統合】
- プラグイン拡張システム【対応: 上記「優先度: 低」の同名タスクと統合】
- レスポンシブUI/アクセシビリティ【対応: 上記「優先度: 低」の関連タスク（レスポンシブUI改善/アクセシビリティ向上）と統合】

## メモ

- IssueはGitHubリポジトリ作成後にテンプレートから起票してください。
- v0.3.21 でバックログ整理完了。検索置換・ヘルプ・自動保存・ドキュメント切替UXを実装済み。
