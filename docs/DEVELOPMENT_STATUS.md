# プロジェクト開発項目表

## コア設計思想

### ガジェットベースアーキテクチャ

Zen Writerは「メモ帳以上の機能はすべてガジェット化」という原則に基づいています。

#### 主要コンセプト

1. **完全モジュラー設計**
   - すべての追加機能はガジェットとして実装
   - ガジェットは独立した単位で開発・テスト可能
   - `ZWGadgets.register(name, factory, options)` で登録

2. **動的タブシステム**
   - タブは基本1つから開始
   - ユーザーが自由にタブを追加・削除可能
   - 各タブに任意のガジェットを配置可能

3. **プリセット（ロードアウト）システム**
   - 初心者向けに推奨構成を提供（`novel-standard`, `screenplay`, `minimal`）
   - ユーザーが独自のプリセットを作成・保存可能
   - ワンクリックで構成を切り替え

4. **フレキシブルレイアウト**（計画中）
   - タブを上下左右に配置可能
   - サイドバーから切り離してフローティング表示
   - 透明度調整、表示/非表示トグル
   - セーブボタン、フォント装飾などを想定

#### 現在の実装状況

- [x] ガジェット登録・レンダリングシステム
- [x] ロードアウトの保存・適用機能
- [x] 動的タブ追加・削除のAPI（`sidebarManager.addTab/removeTab`）
- [~] タブへのガジェット動的割り当て（部分実装）
- [ ] フローティングパネル機能（未実装）
- [ ] 柔軟な配置システム（未実装）

## 直近の開発項目 (v0.3.16 実装済み)

| カテゴリ | 項目 | 詳細 | ステータス |
|----------|------|------|------------|
| UI将来強化 | OpenSpec `ui-future-enhancements` 実装 | タイプライター精度向上、Markdown最小プレビュー・ショートカット・リスト継続、プレビュー内リンクナビ | Done |
| 設定UI | エディタタブ追加 | タイプライターモードとスナップショット設定を追加 | Done |
| タイプライターモード | ミラーDOM計測 | 精度向上、設定UIで有効化/アンカー/張り付き調整 | Done |
| Markdown機能 | ショートカット・リスト継続 | Ctrl/Cmd+B/I/Kショートカット、Enterでのリスト自動継続 | Done |
| 最小ライブプレビュー | 見出し/強調/リスト/リンク | Markdown要素のリアルタイムプレビュー | Done |
| スナップショット | 設定UI調整 | 間隔/差分/保持数調整、retention実装 | Done |
| E2Eテスト | editor-settings.spec.js | 設定永続化検証 | Done |
| ツリーペイン | 最小実装 | ドキュメント/ガジェットツリー表示、展開/折りたたみ、クリックナビ、設定保存 | Done |
| Corkboard | 最小実装 | テキストカード追加・ドラッグ並び替え、Enterキー新規カード作成 | Done |
| Markdown拡張 | コードブロック・目次 | 簡易表示、リンク生成・スクロール同期トグル | Done |
| Images Interactive | プリセット・コントロール | VN肖像/背景/挿絵/テキストボックス用プリセット、不透明度・フィルター数値コントロール | Done |
| Images Interactive | スナップショット | 画像状態の保存・復元機能 | Done |
| Content Linking | モデル・ナビゲーション | doc://, asset://, http(s)://リンクサポート、クリックナビとホバー・プレビュー | Done |
| Panels Layout | Docking/splitモデル | ゾーン・永続化、キーボードナビゲーションとアクセシビリティ | Done |

## 今後の開発予定項目

| カテゴリ | 項目 | 詳細 | 優先度 |
|----------|------|------|--------|
| OpenSpec仕様 | Draft capability deltas | この変更のcapability deltasをドラフト | 高 |
| OpenSpec仕様 | Validate with strict mode | strict modeでの検証 | 高 |
| テーマ・背景 | Dark mode palette expansion | ダークモードパレット拡張 | 低 |
| テーマ・背景 | Background visuals | スクロール連動・ランダム化の背景ビジュアル | 低 |
| QA・ドキュメント | E2E & smoke updates | E2Eとsmokeテストの更新 | 中 |
| QA・ドキュメント | USAGE/CHANGELOG updates | USAGEとCHANGELOGの更新 | 中 |
| UI/UX改善 | 左サイドバー展開時のメインエリア隠れ修正 | パネルレイアウト調整 | 中 |
| UI/UX改善 | カラーパレットの現在の色反映機能 | 実装 | 中 |
| UI/UX改善 | エディタキー移動時のガクガク振動修正 | スクロール挙動改善 | 中 |
| UI/UX改善 | 折り返し文字数指定機能 | 追加 | 中 |
| UI/UX改善 | 文字数表示スタンプ機能 | 区切り・段落集計の実装 | 中 |
| UI/UX改善 | 編集ファイル/章の表示・一覧機能 | UX向上 | 中 |
| UI/UX改善 | 破棄確認・復元機能強化 | 変更追跡 | 中 |
| パフォーマンス最適化 | updateWordCount デバウンス | 長文での文字数更新頻度低減 | 高 |
| パフォーマンス最適化 | typewriter scroll requestAnimationFrame | caret移動時のスクロール計算スムーズ化 | 高 |
| パフォーマンス最適化 | live preview 差分適用 | markdown変換のリアルタイム性向上 | 高 |
| パフォーマンス最適化 | selection range measurement | 文字数スタンプの位置計算負荷削減 | 中 |

※ v0.3.18 時点では、次の項目は実装済みです（詳細は `CHANGELOG.md` を参照してください）。
- OpenSpec仕様: Draft capability deltas / Validate with strict mode
- UI/UX改善: カラーパレットの現在の色反映機能
- UI/UX改善: エディタキー移動時のガクガク振動修正
- UI/UX改善: 折り返し文字数指定機能 / 文字数表示スタンプ機能 / 編集ファイル/章の表示・一覧機能
- パフォーマンス最適化: typewriter scroll requestAnimationFrame

## 直近の開発項目 (v0.3.23 実装済み)

| カテゴリ | 項目 | 詳細 | ステータス |
|----------|------|------|------------|
| フェーズC | データ属性スキーマ | GADGET_GROUPS 定数、getGroupPanel/getGroupSection ヘルパー関数 | Done |
| フェーズC | セレクタ移行 | gadgets-init.js, gadgets-core.js をデータ属性ベースに更新 | Done |
| フェーズC | 責務分離 | SidebarManager/ZWGadgets の責務をコメントで明確化 | Done |
| UIラベル | 重複解消 | ui-labels.js のロードアウト関連キーを Loadout UI セクションに集約 | Done |
| ドキュメント | BACKLOG整理 | フェーズC完了、タスクステータス更新 | Done |

## 以前の開発項目 (v0.3.22 実装済み)

| カテゴリ | 項目 | 詳細 | ステータス |
|----------|------|------|------------|
| ロードアウト | ガジェット化 | gadgets-loadout.js に分離、HTMLから静的要素削除 | Done |
| コード品質 | 絵文字除去 | ドキュメント内の絵文字をテキスト/チェックボックスに変更 | Done |
| パフォーマンス | 貼り付けテスト | 5k-50k文字で約300ms（許容範囲） | Done |
| UIラベル | 統一化 | ロードアウト/プロファイル関連ラベルを ui-labels.js に集約 | Done |
| パフォーマンス | 選択範囲最適化 | updateCharCountStamps に100msデバウンス追加 | Done |
| BACKLOG | 次期フェーズ案 | v0.4.x ロードマップ（C/D/E フェーズ）を追加 | Done |

## 以前の開発項目 (v0.3.21 実装済み)

| カテゴリ | 項目 | 詳細 | ステータス |
|----------|------|------|------------|
| Help | ガジェット追加 | 全ロードアウトの assist グループに Help を追加 | Done |
| 自動保存 | 設定UI | UISettings に自動保存の有効/無効・遅延設定を追加 | Done |
| ドキュメント切替 | UX改善 | 自動保存有効時は確認ダイアログなしで即保存・切替 | Done |
| BACKLOG | ステータス整理 | 検索置換・ヘルプ・自動保存を実装済みにマーク | Done |

## 以前の開発項目 (v0.3.20 実装済み)

| カテゴリ | 項目 | 詳細 | ステータス |
|----------|------|------|------------|
| Visual Profile | Phase B 実装 | ユーザー定義プロファイル保存/読込/削除、ガジェットUI | Done |
| Wiki | レイアウト修正 | 3カラム→1カラムに変更、サイドバー内で適切に表示 | Done |
| UI安定化 | スクロールバー対策 | scrollbar-gutter: stable でレイアウトシフト防止 | Done |
| UI安定化 | ダークテーマフォーム | サイドバー内全フォーム要素のダークテーマ対応 | Done |
| ロードアウト | 外部化 | loadouts-presets.js に分離、脚本プリセット追加 | Done |
| ヘルプ | ガジェット更新 | Visual Profile、ロードアウト説明追加 | Done |
| ドキュメント | EDITOR_HELP.md | Visual Profile、Markdown機能、Wiki使い方を追加 | Done |

## 以前の開発項目 (v0.3.19 実装済み)

| カテゴリ | 項目 | 詳細 | ステータス |
|----------|------|------|------------|
| Visual Profile | Phase A 実装 | 概念モデル、最小UI、組み込みプロファイル（ライト/ダーク/余白広め） | Done |
| Visual Profile | editorWidthMode | narrow/medium/wide の3モード実装、CSS変数連携 | Done |
| Visual Profile | UIモード分離 | レイアウトシフト抑制のためUIモードをVisual Profileから分離 | Done |
| ダークテーマ | コントラスト調整 | Obsidian/Quiver風にリファイン（サイドバー暗め、エディタ明るめ） | Done |
| UI改善 | ラベル短縮化 | 「+ 新規」「読込」「TXT保存」等の簡潔なラベルに変更 | Done |
| UI改善 | ボタンサイズ統一 | ガジェット内ボタンの一貫したスタイリング | Done |
| UI改善 | サイドバーレイアウト安定化 | 空ヘッダー非表示、コンパクト化CSS追加 | Done |
| ドキュメント | UIデザイン指針 | Zen Writer × ノートアプリ折衷指針を DESIGN.md に追加 | Done |

## プロジェクト・マイルストーン

- **v0.3.17 (2025-11-06)**: サイドバーアニメーションとUI安定化の修正完了
- **v0.3.18 (2025-01-11)**: カラーパレット現在色反映、タイプライターモードのスクロール改善、UI改善テストドキュメント整備
- **v0.3.19 (2025-11-30)**: Visual Profile Phase A、ダークテーマ調整、UIラベル短縮化、サイドバーレイアウト安定化
- **v0.3.20 (2025-11-30)**: Visual Profile Phase B、Wikiレイアウト修正、スクロールバー対策、ロードアウト外部化
- **v0.3.21 (2025-11-30)**: Helpガジェット追加、自動保存設定UI、ドキュメント切替UX改善
- **v0.3.22 (2025-11-30)**: ロードアウトガジェット化、絵文字除去、UIラベル統一、パフォーマンス最適化
- **v0.3.23 (2025-11-30)**: フェーズC完了（サイドバー構造安定化、データ属性スキーマ導入、責務分離明確化）
- **次期リリース予定**: フローティングパネル（Phase E）/ 破棄確認・復元機能強化
