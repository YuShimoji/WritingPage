# ISSUES — 初期Issueの整理（提案）

プロジェクトの初期バックログとして、以下のIssueを作成することを推奨します。各Issueには目的、受け入れ条件（DoD）、補足を記載しています。

---

## 1) 複数ドキュメント管理

- 目的: 小説を章や作品ごとに分割・切替できるようにする
- DoD:
  - [ ] ドキュメント一覧が表示できる
  - [ ] 新規作成/名称変更/削除ができる
  - [ ] 自動保存がドキュメント単位で機能する
- 補足: LocalStorageのキー命名規則を策定（例: `zenWriter_docs:index`, `zenWriter_doc:{id}`）

## 2) テーマプリセットの拡充

- 目的: 利用環境や嗜好に応じた配色を容易に選べる
- DoD:
  - [ ] High Contrast, Solarized Light/Dark をプリセット追加
  - [ ] プリセット名・配色定義を1箇所に集約
  - [ ] README/TESTINGの更新

## 3) オートバックアップ（スナップショット）

- 目的: 誤操作やブラウザ障害時の安全性向上
- DoD:
  - [ ] 一定間隔/変更量でスナップショットを保存
  - [ ] スナップショット一覧から復元
  - [ ] 保存容量の上限と古い世代のローテーション

## 4) 印刷/PDF対応

- 目的: 原稿提出・校正のための出力品質向上
- DoD:
  - [ ] 印刷用CSS（余白/段落/ページ区切り）
  - [ ] READMEにPDF出力手順（ブラウザ印刷）

## 5) 執筆目標と進捗

- 目的: モチベーション維持と計画的執筆
- DoD:
  - [ ] 文字数目標/締切の設定
  - [ ] 進捗バー/残り文字数の表示

## 6) アクセシビリティ検証

- 目的: コントラストやキーボード操作の改善
- DoD:
  - [ ] コントラスト比の確認（WCAG基準）
  - [ ] フォーカスリング/ショートカットの見直し

## 7) コード品質/自動化

- 目的: 将来の拡張に備えた品質担保
- DoD:
  - [ ] ESLint/Prettier 導入（CIは任意）
  - [ ] .editorconfig 追加

---

作成後は `docs/BACKLOG.md` と整合を取り、進捗に応じて更新してください。

## 8) カラーパレットUIの追加

- 目的: カラープリセットから素早く配色を選択・プレビュー・適用できるようにする
- DoD:
  - [ ] パレット表示（色チップの一覧、アクセント含む任意3〜5色）
  - [ ] ホバー/選択時のプレビュー（未確定の一時適用）
  - [ ] 決定/取消の操作（確定適用と元に戻す）
  - [ ] TESTINGとUSAGEの更新

## 10) 階層的設定テンプレート（大きなまとまり＞まとまり＞各要素）

- 目的: 部/章/節などに限らず、ユーザーが任意の階層テンプレートを定義し、名称と順序、色などを柔軟に設定できるようにする
- DoD:
  - [ ] 階層テンプレートの作成/編集/削除（LocalStorage保存）
  - [ ] 各階層に対し「名称/キー/色」を設定可能
  - [ ] テンプレート切替でサイドバーの挿入ボタンと色が更新
  - [ ] USAGE/TESTING/PALETTE_DESIGNの更新

## 12) 自動配色抽出とテーマカラー生成

- 目的: ベース色から補色・類似色・強調色を自動生成し、良さげな配色プリセットを提案する
- DoD:
  - [ ] HSL/OKLCH 等の色空間を用いたパレット生成アルゴリズム（明度・彩度ガイドライン）
  - [ ] 生成パレットのプレビューと適用/取消
  - [ ] 生成結果をユーザー定義プリセットとして保存/再利用可能
  - [ ] USAGE/TESTING/THEMESの更新

## 13) 高度なテーマプリセット（フォント/ページカラー/アクセントの一括適用）

- 目的: テキストフォント、ページ背景、UIアクセント等に跨る組合せを1つの「テーマカラー」として適用できるようにする
- DoD:
  - [ ] テーマ定義スキーマの策定（フォント/サイズ/行間/色一式）
  - [ ] プリセット管理（追加/削除/適用）
  - [ ] 既存のテーマ/カスタム色/フォント設定と整合性を保つ
  - [ ] USAGE/TESTING/THEMESの更新

## 9) ユーザー定義配色プリセット

- 目的: ユーザーが自分好みの配色を保存/読み込みできるようにする
- DoD:
  - [ ] 現在の配色（背景/文字/アクセント）をプリセットとして保存（LocalStorage）
  - [ ] 保存済みプリセットの一覧/適用/削除
  - [ ] エクスポート/インポート（JSON）
  - [ ] TESTINGとUSAGEの更新

---

## 14) 用語整備・仕様遵守（UIラベルの統一）

- 目的: 仕様書に記載のない用語（例: 「賞名」）がUIに混在しているため、用語を仕様に沿って統一し、ユーザーの混乱を防ぐ
- DoD:
  - [ ] 現状のUIラベルの棚卸しと差分一覧（仕様との突合）
  - [ ] 用語ガイドライン（CONVENTIONS.md または新規ドキュメント）に決定を反映
  - [ ] UIラベル・プレースホルダー・ヘルプテキストの一括置換
  - [ ] 国際化（将来対応）を見据えたキー化（data-i18n 等）方針の草案

## 15) テーマUIの極小化と「設定ハブ」への移動

- 目的: 左サイドバーの情報過多を解消し、テーマ等のカスタム要素は別の設定ハブ（ドロワー/ダイアログ）に集約する
- DoD:
  - [ ] 左サイドバーから「テーマ」セクションを折りたたみ/最小化（初期は閉）
  - [ ] 「詳細設定」ボタンで設定ハブ（モーダル or 右ドロワー）を開く導線を追加
  - [ ] 設定ハブに「テーマ/フォント/配色/高度なテーマプリセット」を再配置
  - [ ] 既存ショートカット（フォントサイズ等）との整合性とドキュメント更新

## 16) アウトライン項目のユーザー並び替え（部/章/節/話など）

- 目的: アウトラインの階層項目をユーザーが任意に並べ替え可能にし、執筆スタイルへ柔軟に適応
- DoD:
  - [ ] 並び替えUI（ドラッグ＆ドロップ、または上下ボタン）を提供
  - [ ] 並び順をLocalStorageへ保存/復元
  - [ ] 挿入ボタンの順序/色が並び替え結果に連動
  - [ ] USAGE/TESTINGの更新

## 17) フォント設定の適用範囲の明確化（本文 vs UI）

- 目的: 「フォント」が小説本文用かサイトUI用かが不明瞭なため、適用範囲を分離
- DoD:
  - [ ] CSS変数を本文用（--content-font-...）とUI用（--ui-font-...）に分離
  - [ ] 設定UIで「本文フォント」「UIフォント」を独立して設定/保存
  - [ ] 既存テーマ/プリセットとの整合性を担保
  - [ ] ドキュメント（THEMES.md/USAGE.md/TESTING.md）更新

## 18) 見出し階層のハードコーディング解消

- 目的: 章/節/部 等の固定前提を排し、OutlineManagerのテンプレート機構に一本化
- DoD:
  - [ ] コード全体を点検し、固定ラベルのハードコーディングを撤廃
  - [ ] DEFAULT_OUTLINE は初期値としてのみ使用し、全UIはテンプレートに依存
  - [ ] リグレッションテスト（既存テンプレートとの互換）

## 19) ワードカウントバーの開閉（常時表示/自動隠し/手動トグル）

- 目的: 執筆集中を阻害しないよう、上部の文字数/語数バーを開閉可能にする
- DoD:
  - [ ] バーの折りたたみ/展開（状態は保存、初期状態の設定可）
  - [ ] キーボードショートカット（例: Ctrl/Alt+W）でトグル
  - [ ] 自動非表示（入力停止/再開でフェード）オプション
  - [ ] USAGE/TESTING 更新

## 20) フェードイン/アウト型ミニHUD（拡張可能な小ウィンドウ）

- DoD:
  - [ ] HUDのUIコンポーネント（CSSアニメーション/位置/サイズ）
  - [ ] API（publish(message, type, duration), pin(), close() など）
  - [ ] 文字数/語数の一時表示を標準実装。後から他機能（例えばタイマー、進捗、ゴール）を追加可能
  - [ ] アクセシビリティ考慮（コントラスト、フォーカス移動、スクリーンリーダー）
- [ ] USAGE/TESTING 更新

<!-- sync: v0.3.1 2025-09-24 -->

---

## 21) 埋め込み用エディター（Embed SDK v1）

- 目的: 他サイトに本エディターを簡単に埋め込み可能にする（別機能として分離、既存ページは変更しない）
- DoD:
  - [ ] `js/embed/zen-writer-embed.js` を提供。`ZenWriterEmbed.create(target, options)` で `iframe` を生成
  - [ ] postMessage で親子通信の仕様策定（READY/GET_CONTENT/SET_CONTENT/FOCUS/TAKE_SNAPSHOTなど）
  - [ ] `docs/EMBED_SDK.md` を作成（API/イベント/サンプルコード/セキュリティ）
  - [ ] `index.html` 側に `?embed=1` 起動パラメータに応じた軽量モード（将来）
  - [ ] USAGE/TESTING 更新、サンプル `embed-demo.html`（任意）

## 22) スナップショット拡張（保持数/閾値/タグ/差分）

- 目的: 既存スナップショット機能を強化し、信頼性と操作性を高める
- DoD:
  - [ ] 保持数/間隔/文字数閾値を設定から変更可能
  - [ ] ドキュメントID紐付け、フィルタリング
  - [ ] タグ/メモ付与、手動/自動の区別
  - [ ] 復元前プレビューと差分表示（段落単位）
  - [ ] エクスポート/インポート（JSON）
  - [ ] `docs/SNAPSHOT_DESIGN.md` 追加、USAGE/TESTING 更新

## 23) 選択ツールチップ（Quick Actions）と装飾/挿入UI

- 目的: テキスト選択時に小さなツールチップを表示し、簡易操作で装飾や挿入を行う
- DoD:
  - [ ] 選択に追従するツールチップUI（位置計算/スクロール/エスケープで閉じる）
  - [ ] 装飾: 強調（`**…**`）、斜体（`*…*`）、取り消し線（`~~…~~`）
  - [ ] 挿入: リンク（`[text](url)`）、画像（`![alt](url)`）、区切り（`---`）
  - [ ] ルビ挿入: `|漢字《かんじ》` 形式（印刷時はそのまま、将来コンバータでHTML化）
  - [ ] プラグイン拡張点（`registry.js` に selection アクションを登録可能）
  - [ ] `docs/EDITOR_EXTENSIONS.md` 追加、USAGE/TESTING 更新

## 24) 画像挿入（IndexedDB 附帯オプション）

- 目的: 画像を安全に本文へ挿入（Markdown）。ローカルファイル/URL/貼り付け
- DoD:
  - [ ] まずはURL貼付/入力をサポート（`![alt](https://...)`）
  - [ ] オプション: IndexedDB にバイナリ保存し、`zw-asset:<id>` の仮想URLで参照→`service worker` で配信（将来）
  - [ ] 貼付（Clipboard）から画像を検出し、挿入前に確認ダイアログ
  - [ ] 容量と上限警告、USAGE/TESTING 更新

## 25) デザイン/設定の分離（設定ハブ & デザインツールチップ）

- 目的: デザイン系UIをいつでも分離可能・呼び出し可能に整理
- DoD:
  - [ ] 右ドロワー型の設定ハブ（別UI）を追加（モーダル/`<dialog>` でも可）
  - [ ] サイドバーからは最小情報のみ。詳細は「設定ハブを開く」導線
  - [ ] デザインツールチップ（簡易パレット/プレビュー/適用）の設計
  - [ ] ドキュメント（DESIGN.md, USAGE.md, TESTING.md）更新
